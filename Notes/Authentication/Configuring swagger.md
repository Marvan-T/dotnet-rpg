# Configuring Swagger for Authentication

## What's Swagger?
Swagger, a popular tool for building APIs with a user interface that developers can interact with. Swagger is often used to help develop, test, and document APIs.

First we need to add a `dotnet add package Swashbuckle.AspNetCore.Filters`

```csharp
builder.Services.AddSwaggerGen(c =>
{
    c.AddSecurityDefinition("oauth2", new OpenApiSecurityScheme
    {
        Description = """Standard Authorization header using the Bearer scheme. Example: "bearer {token}" """,
        In = ParameterLocation.Header,
        Name = "Authorization",
        Type = SecuritySchemeType.ApiKey
    });

    c.OperationFilter<SecurityRequirementsOperationFilter>();
    });
```

Here's a more detailed breakdown of what the code is doing:

1. `builder.Services.AddSwaggerGen(c => {...})`: This line is adding and configuring SwaggerGen to the application's services through dependency injection. SwaggerGen is a tool that generates Swagger documents based on your ASP.NET Core web API data annotations. These documents can then be used by the Swagger UI to provide an interactive documentation of your API.

2. `c.AddSecurityDefinition("oauth2", new OpenApiSecurityScheme {...})`: This block is defining a security scheme for the Swagger document. Security scheme is a way to describe the authentication and authorization methods used by the API. In this case, the security scheme is named "oauth2", and it's of type `ApiKey`. 

   - `Description`: This property contains a string that describes how the API key should be used. In this case, it says that the API key should be included in the Authorization header using the Bearer scheme. The `{token}` is a placeholder for the actual token value.

   - `In`: This property defines where the API key should be sent. In this case, it should be in the header of the HTTP request.

   - `Name`: This property defines the name of the header where the API key should be included. Here, it's "Authorization".

   - `Type`: This property indicates the type of the security scheme. In this case, it's `ApiKey`, which means the API uses a simple API key for authentication.

3. `c.OperationFilter<SecurityRequirementsOperationFilter>();`: This line is adding an operation filter to Swagger. An operation filter allows you to post-process or modify operation descriptions once they've been initially generated by Swagger. The `SecurityRequirementsOperationFilter` is a custom operation filter that adds the security requirements to each operation in the Swagger document.

The goal of this code is to ensure that the Swagger documentation correctly represents the authentication mechanism of the API. By doing this, developers who are using the Swagger UI to test your API will know that they need to provide an Authorization header with a Bearer token. This helps to ensure that your API's security requirements are clearly communicated and understood by anyone who is using it.